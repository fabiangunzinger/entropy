% !TEX root = ../entropy.tex

\section{Data}%
\label{sec:data}


\subsection{Dataset description}
\label{sub:dataset_description}
Data is provided by Money Dashboard (MDB), a UK-based
financial management app that allows its users to add accounts from all
their banks to obtain an integrated view of their finances. Our
dataset contains information on more than 500 million transactions made between
2012 and June 2020 by more than 250,000 users. For each transaction, we can see
the amount, date, and description of the transaction, as well as transaction
\textit{tags}, classifications added by MDB that indicate the type of the
transaction (e.g.  `groceries', `insurance'). We also have basic information
 on each user (e.g. year of birth, postcode sector) as well information about
each bank account (e.g. type of account, date added).

The main advantages of the data for the study of consumer financial behaviour
are its high (transaction-level) frequency, that it is automatically
collected and updated and thus less prone to errors and unaffected by biases
that bedevil survey measures, and that it offers a view of consumers' entire
financial life across all their accounts, rather than just a view of their
accounts held at a single bank (provided they added all their accounts to MDB).

The main limitation is the non-representativeness of the sample relative to the
population as a whole. Financial management apps are known to be used
disproportionally by men, younger people, and people of higher socioeconomic
status \citep{carlin2019generational,mas2014money}. Also, as pointed out in
\citet{gelman2014harnessing}, a willingness to share financial information with
a third party might not only select on demographic characteristics, but also
for an increased need for financial management, or, one could argue, for a
higher degree of financial sophistication. However, while
non-representativeness could partially be addressed by re-weighting the sample,
as was done in \citet{bourquin2020effects}, it is not of much consequence for
our purpose here, since our ability to infer behaviour traits from transaction
data is not dependent on having a representative sample of people.

Further limitations:
\begin{itemize}
    \item To the extent that users link shared accounts, they might be more
        appropriately thought of as households rather than individual usres
    \citep{bourquin2020effects}. We assume that in the majority of cases,
    shared partner accounts are used for shared household expenses rather than
    personal expenses, and that salary payments are paid into personal
    accounts. To the extent that this is true, identified salaries are to a
    single individual, and expenses made by a partner with a shared account
    would mainly be for household items that an individual would have also
    purchased if they lived on their own (albeit in smaller quantities), but
    not for additional spending categories, which would impact our entropy
    spending tag based entropy measure.

    \item Some accounts might be business accounts. Using versions of the
        algorightms used by \citet{bourquin2020effects} to identify such
        accounts showed, however, that such accounts only make up a tiny
        percentage of overall accounts and would not influence our results. We
        thus do not exclude them.
\end{itemize}



\subsection{Preprocessing and sample selection}%
\label{sub:preprocessing_and_sample_selection}

The MDB data is noisy. We perform a number of preprocessign steps to deal with
that.

\begin{itemize}
    \item Duplicates handling.
    \item We trim all variables at the 1-percent level on the upper end of the
        distribution for variables that take non-negative values only and on
        both ends of the distribution for all other variables. We trim
        (replace outliers with missing values) rather than winsorise (replace
        outliers with the cutoff percentile value) because we believe that
        outliers result from errors in the data rather than represent genuine
        information.
    \item Actually, we don't do either of the above. With the harsher selection
        methods, the statistics are very reasonable, which, if anything, would
        suggest using winsorizing. However,
        [this](https://blogs.sas.com/content/iml/2017/02/08/winsorization-good-bad-and-ugly.html)
        article convincingly argues that we shouldn't do that in our case.
\end{itemize}


\begin{table}[H]
\caption{Sample selection}\label{tab:selection}
\input{\tabdir/sample_selection_XX7.tex}
\end{table}


\subsection{Summary statistics}%
\label{sub:summary_statistics}

The four panels in Figure~\ref{fig:sumstats} provide an overview of
demographic characteristics of our sample. It makes clear that Money Dashboard
users are not a representative sample of the UK population: they are
predominantly males in their thirties who live in London or the South East and
are relatively well off (the income distribution is shifted to the right
relative to the UK as a whole).\footnote{To calculate incomes, we broadly
    follow \citet{hacioglu2020distributional} in defining total income as the
sum of earnings, pension income, benefits, and other income.} 

\begin{figure}[H]
    \caption{Demographic characteristics of Money Dashboard users}
    \label{fig:sumstats}
    \begin{center}
        \includegraphics[width=0.49\textwidth]{\figdir/user_age_hist.png}
        \includegraphics[width=0.49\textwidth]{\figdir/user_income_hist.png}
        \includegraphics[width=0.49\textwidth]{\figdir/user_region_distr.png}
        \includegraphics[width=0.49\textwidth]{\figdir/user_gender_distr.png}
    \end{center}
\end{figure}

\begin{figure}[H]
    \center \newcommand\width{.9\textwidth} \caption{Monthly
        transactions by account type}    \label{fig:monthly_txns}
        \begin{center}
            \includegraphics[width=\width]{\figdir/num_txns_by_account_type.png}
            \fignote{\width}{The two innermost boxes in the
                \href{https://vita.had.co.nz/papers/letter-value-plot.html}{letter-value
                plots} are identical to those in a boxplot, with the center line
                corresponding to the median and the left and right edges to the
                first and third quartiles, respectively -- or half of the remaining
                data on either side of the median.  Additional boxes on either side
                extend that principle by corresponding to half of the remaining
                data on that side. For instance, the second box to the right of the
                median in the current accounts plot indicates that half of all
                account-month observations to the right of the third quartile have
                fewer than about 105 transactions. Boxes of the same height
                correspond to the same level, individually drawn observations are
            outliers.}
        \end{center}
\end{figure}

\begin{table}[H]
\caption{Summary statistics}\label{tab:sumstats}
\input{\tabdir/sumstats.tex}
\end{table}


\subsection{Dependent variable}%
\label{sub:dependent_variable}

There is no single variable that captures an indiviual's monthly savings.
Instead, we capture savings by looking at account balances and
flows into savings accounts. Specifically, we focus on the following 
measures, each defined at the user-month level.

\begin{itemize}
    \item Mean balance across all savings accounts

    \item Mean balance across all savings and current accounts

    \item Total inflows into savings accounts

    \item Net inflows (inflows minuts outflows) into savings accounts
\end{itemize}

\edit{todo: decide whether to scale inflows by monthly income}
 
We calculate savings account inflows as the sum of all credits that are not
identified as interest payments into a user's savings accounts. We would expect
that it is particularly non-standing-order transactions into savings accounts
that are related to entropy, and it might thus be reasonable to exclude
standing orders. However, while we cannot perfectly identify standing orders,
they seem to account only for a small proportion of all savings account
transfers and are thus unlikely to affect our results. Because of that, we do
not exclude them.

\begin{figure}[H]
    \center \newcommand\width{\textwidth} \caption{Monthly flows in and out of savings
    accounts}
    \label{fig:monthly_savings}
    \includegraphics[width=\width]{\figdir/monthly_savings.png}
    \fignote{\width}{Flows are calculated for each user-month as the total
    inflows, outflows, and flows (calculated as inflows - outflows) into all
of a users's savings accounts. Zero net flows represent
months where inflows are either perfectly balanced by outflows or where there
were no flows at all.}
\end{figure}


\subsection{Independent variable}%
\label{sub:independent_variable}

Spending entropy:

\begin{itemize}

    \item We calculate spending entropy using the Shannon entropy
        \textit{H}\citep{shannon1948mathematical}, defined as

        \begin{equation}
            H = -\sum{p_i}log(p_i),
        \end{equation}

    where $p_i$ is the probability that an individual makes a purchase in
    spending category $i$, and $log$ is the base 2 logarithm. The measure can
    broadly be interpreted as the degree to which an individual's spending
    pattern is predictable, whith a higher score indicating less
    predictability.

    \item To calculate individual entropy scores, we group spending into 9
        spending categories (SC), based on the classification used by Lloyds
        Banking Group as discussed in \citet{muggleton2020evidence}.

    \item Also following that paper, when calculating $p_i$ we use additive
        smoothing and add one to the numerator and $N_{SC}$ to the denominator
        to avoid taking logs of zero counts in cases where an individual makes
        no purchases in a given spending category. $p_i$ is thus calculated as

        \begin{equation}
            p_i = \frac{\text{Count of purchases in $SC_i$} + 1}{\text{Count of
            all purchases} + 9}
        \end{equation}

\end{itemize}

\begin{figure}[H]
    \center \newcommand\width{\textwidth} \caption{Transactions distributions}
    \label{fig:entropy_dist}
    \includegraphics[width=\width]{\figdir/txns_breakdowns_and_entropy.png}
    \fignote{\width}{From top-left to bottom-right: distribution of spending
    transactions per user-month, breakdown of spending transactions into
spending categories; breakdown of number of spending categories spent on in
user-month; distribution of user-month entropy scores.}

\end{figure}

\subsection{Control variables}%
\label{sub:control_variables}

We calculate age as an individual's approximate age at the time of the
transactions, by subtracting a user's year of birth from the year the
transaction took place.

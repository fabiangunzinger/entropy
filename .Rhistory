group_by(q) %>%
summarise(across(everything(), mean)) %>%
filter(q %in% c(1, 3, 5)) %>%
pivot_longer(!q) %>%
ggplot(aes(reorder(name, desc(value)), value, fill = q)) +
geom_bar(stat = "identity", position = "dodge") +
labs(
x = spendlabs[[varname]],
y = "Average number of transactions",
fill = "Entropy\nquintile"
) +
theme(
axis.text.x = element_blank(),
legend.position = c(0.9, 0.8)
)
}
varname <- "tag_spend"
fn <- glue("spend_profile_{varname}.pdf")
spend_profile(df, varname)
ggsave(file.path(FIGDIR, fn), height = 10, width = 20, units = "cm")
varname <- "tag"
fn <- glue("spend_profile_{varname}.pdf")
spend_profile(df, varname)
ggsave(file.path(FIGDIR, fn), height = 10, width = 20, units = "cm")
library(tidyverse)
library(ggplot2)
source('./src/config.R')
source('./src/helpers/helpers.R')
df <- read_analysis_data()
length(grep("ct_tag_spend", names(df), value=TRUE))
library(stargazer)
source('./src/config.R')
source('./src/helpers/helpers.R')
df = read_analysis_data()
names(df)
vars <- c(
"^has_inflows$",
"^month_spend$",
"^is_urban$",
"^is_female$",
"^age$",
"^month_income$",
"^has_month_income$",
"^has_inflows$",
"^nunique_tag_spend$",
"^nunique_tag$",
"^nunique_merchant$",
)
varlabs <- c(
"Month income (\\pounds'000)",
"Has income in month",
"Makes savings txns.",
"Month spend (\\pounds'000)",
"Age (years)",
"Female",
"Urban",
"Unique categories (9)",
"Unique categories (48)",
"Unique categories (Merch.)"
)
tabname <- 'sumstats.tex'
stargazer(
df,
summary.stat = c('mean', 'sd', 'min', 'p25', 'median', 'p75', 'max'),
digits = 2,
float = FALSE,
keep = vars,
covariate.labels = varlabs,
out = file.path(TABDIR, tabname)
)
vars <- c(
"^has_inflows$",
"^month_spend$",
"^is_urban$",
"^is_female$",
"^age$",
"^month_income$",
"^has_month_income$",
"^has_inflows$",
"^nunique_tag_spend$",
"^nunique_tag$",
"^nunique_merchant$",
)
varlabs <- c(
"Month income (\\pounds'000)",
"Has income in month",
"Makes savings txns.",
"Month spend (\\pounds'000)",
"Age (years)",
"Female",
"Urban",
"Unique categories (9)",
"Unique categories (48)",
"Unique categories (Merch.)"
)
names(df)
vars <- c(
"^has_inflows$",
"^month_spend$",
"^is_urban$",
"^is_female$",
"^age$",
"^month_income$",
"^has_month_income$",
"^has_inflows$",
"^nunique_tag_spend$",
"^nunique_tag$",
"^nunique_merchant$",
)
vars <- c(
"^has_inflows$",
"^month_spend$",
"^is_urban$",
"^is_female$",
"^age$",
"^month_income$",
"^has_month_income$",
"^has_inflows$",
"^nunique_tag_spend$",
"^nunique_tag$",
"^nunique_merchant$"
)
varlabs <- c(
"Month income (\\pounds'000)",
"Has income in month",
"Makes savings txns.",
"Month spend (\\pounds'000)",
"Age (years)",
"Female",
"Urban",
"Unique categories (9)",
"Unique categories (48)",
"Unique categories (Merch.)"
)
tabname <- 'sumstats.tex'
vars <- c(
"^has_inflows$",
"^month_spend$",
"^is_urban$",
"^is_female$",
"^age$",
"^month_income$",
"^has_month_income$",
"^has_inflows$",
"^nunique_tag_spend$",
"^nunique_tag$",
"^nunique_merchant$"
)
varlabs <- c(
"Month income (\\pounds'000)",
"Has income in month",
"Makes savings txns.",
"Month spend (\\pounds'000)",
"Age (years)",
"Female",
"Urban",
"Unique categories (9)",
"Unique categories (48)",
"Unique categories (Merch.)"
)
tabname <- 'sumstats.tex'
stargazer(
df,
summary.stat = c('mean', 'sd', 'min', 'p25', 'median', 'p75', 'max'),
digits = 2,
float = FALSE,
keep = vars,
covariate.labels = varlabs,
out = file.path(TABDIR, tabname)
)
tabname <- 'sumstats.tex'
names(df)
vars <- c(
"^has_inflows$",
"^month_spend$",
"^is_urban$",
"^is_female$",
"^age$",
"^month_income$",
"^has_month_income$",
"^has_inflows$",
"^nunique_tag_spend$",
"^nunique_tag$",
"^nunique_merchant$"
)
varlabs <- c(
"Month income (\\pounds'000)",
"Has income in month",
"Makes savings txns.",
"Month spend (\\pounds'000)",
"Age (years)",
"Female",
"Urban",
"Unique categories (9)",
"Unique categories (48)",
"Unique categories (Merch.)"
)
stargazer(
df,
summary.stat = c('mean', 'sd', 'min', 'p25', 'median', 'p75', 'max'),
digits = 2
)
stargazer(
df,
summary.stat = c('mean', 'sd', 'min', 'p25', 'median', 'p75', 'max'),
digits = 2,
keep = vars,
covariate.labels = varlabs
)
tabname <- 'sumstats.tex'
source('./src/config.R')
tabname <- 'sumstats.tex'
stargazer(
df,
summary.stat = c('mean', 'sd', 'min', 'p25', 'median', 'p75', 'max'),
digits = 2,
keep = vars,
covariate.labels = varlabs,
float = FALSE,
out = file.path(TABDIR, tabname)
)
?stargazer
stargazer(
df,
summary.stat = c('mean', 'sd', 'min', 'p25', 'median', 'p75', 'max'),
digits = 2,
keep = vars,
covariate.labels = varlabs,
float = FALSE,
out = file.path(TABDIR, tabname)
)
varlabs <- c(
"Month income (\\pounds'000)",
"Has income in month",
"Makes savings txns.",
"Month spend (\\pounds'000)",
"Age (years)",
"Female",
"Urban",
"Unique categories (9)",
"Unique categories (48)",
"Unique categories (Merch.)"
)
tabname <- 'sumstats.tex'
stargazer(
df,
summary.stat = c('mean', 'sd', 'min', 'p25', 'median', 'p75', 'max'),
digits = 2,
keep = vars,
covariate.labels = varlabs,
float = FALSE,
out = file.path(TABDIR, tabname)
)
?stargazer
stargazer(
df,
summary.stat = c('mean', 'sd', 'min', 'p25', 'median', 'p75', 'max'),
digits = 2,
keep = vars,
type = "text"
# covariate.labels = varlabs,
# float = FALSE,
# out = file.path(TABDIR, tabname)
)
vars <- c(
"^has_inflows$",
"^month_spend$",
"^is_urban$",
"^is_female$",
"^age$",
"^month_income$",
"^has_month_income$",
"^nunique_tag_spend$",
"^nunique_tag$",
"^nunique_merchant$"
)
varlabs <- c(
"Month income (\\pounds'000)",
"Has income in month",
"Makes savings txns.",
"Month spend (\\pounds'000)",
"Age (years)",
"Female",
"Urban",
"Unique categories (9)",
"Unique categories (48)",
"Unique categories (Merch.)"
)
vars <- c(
"^has_inflows$",
"^month_spend$",
"^is_urban$",
"^is_female$",
"^age$",
"^month_income$",
"^has_month_income$",
"^nunique_tag_spend$",
"^nunique_tag$",
"^nunique_merchant$"
)
varlabs <- c(
"Month income (\\pounds'000)",
"Has income in month",
"Makes savings txns.",
"Month spend (\\pounds'000)",
"Age (years)",
"Female",
"Urban",
"Unique categories (9)",
"Unique categories (48)",
"Unique categories (Merch.)"
)
tabname <- 'sumstats.tex'
stargazer(
df,
summary.stat = c('mean', 'sd', 'min', 'p25', 'median', 'p75', 'max'),
digits = 2,
keep = vars,
covariate.labels = varlabs,
float = FALSE,
out = file.path(TABDIR, tabname)
)
varlabs <- c(
"Month income",
"Has income in month",
"Makes savings txns.",
"Month spend",
"Age (years)",
"Female",
"Urban",
"Unique categories (9)",
"Unique categories (48)",
"Unique categories (Merch.)"
)
tabname <- 'sumstats.tex'
stargazer(
df,
summary.stat = c('mean', 'sd', 'min', 'p25', 'median', 'p75', 'max'),
digits = 2,
keep = vars,
covariate.labels = varlabs,
float = FALSE,
out = file.path(TABDIR, tabname)
)
vars <- c(
"^month_income$",
)
varlabs <- c(
"Month income (\\pounds)",
)
vars <- c(
"^month_income$"
)
varlabs <- c(
"Month income (\\pounds)"
)
tabname <- 'sumstats.tex'
stargazer(
df,
summary.stat = c('mean', 'sd', 'min', 'p25', 'median', 'p75', 'max'),
digits = 2,
keep = vars,
covariate.labels = varlabs,
float = FALSE,
out = file.path(TABDIR, tabname)
)
varlabs <- c(
"Month income ('000)"
)
tabname <- 'sumstats.tex'
stargazer(
df,
summary.stat = c('mean', 'sd', 'min', 'p25', 'median', 'p75', 'max'),
digits = 2,
keep = vars,
covariate.labels = varlabs,
float = FALSE,
out = file.path(TABDIR, tabname)
)
varlabs <- c(
"Month income (\pounds'000)"
tabname <- 'sumstats.tex'
stargazer(
df,
summary.stat = c('mean', 'sd', 'min', 'p25', 'median', 'p75', 'max'),
digits = 2,
keep = vars,
covariate.labels = varlabs,
float = FALSE,
out = file.path(TABDIR, tabname)
)
varlabs <- c(
"Month income (\pound'000)"
varlabs <- c(
"Month income (\pound'000)"
varlabs <- c(
"Month income (\\\pound'000)"
varlabs <- c(
"Month income (\\pound'000)"
)
tabname <- 'sumstats.tex'
stargazer(
df,
summary.stat = c('mean', 'sd', 'min', 'p25', 'median', 'p75', 'max'),
digits = 2,
keep = vars,
covariate.labels = varlabs,
float = FALSE
# ,
# out = file.path(TABDIR, tabname)
)
stargazer(
df,
summary.stat = c('mean', 'sd', 'min', 'p25', 'median', 'p75', 'max'),
digits = 2,
keep = vars,
covariate.labels = varlabs,
float = FALSE,
out = file.path(TABDIR, tabname)
)
varlabs <- c(
"Month income (\\textsterling'000)"
)
tabname <- 'sumstats.tex'
stargazer(
df,
summary.stat = c('mean', 'sd', 'min', 'p25', 'median', 'p75', 'max'),
digits = 2,
keep = vars,
covariate.labels = varlabs,
float = FALSE,
out = file.path(TABDIR, tabname)
)
varlabs <- c(
"Month income ($\\pounds'000$)"
)
tabname <- 'sumstats.tex'
stargazer(
df,
summary.stat = c('mean', 'sd', 'min', 'p25', 'median', 'p75', 'max'),
digits = 2,
keep = vars,
covariate.labels = varlabs,
float = FALSE,
out = file.path(TABDIR, tabname)
)
varlabs <- c(
"Month income (\\pounds'000)"
)
vars <- c(
"^month_income$"
)
varlabs <- c(
"Month income (\\pounds'000)"
)
tabname <- 'sumstats.tex'
stargazer(
df,
summary.stat = c('mean', 'sd', 'min', 'p25', 'median', 'p75', 'max'),
digits = 2,
keep = vars,
covariate.labels = varlabs,
float = FALSE,
out = file.path(TABDIR, tabname)
)
tab <- stargazer(
df,
summary.stat = c('mean', 'sd', 'min', 'p25', 'median', 'p75', 'max'),
digits = 2,
keep = vars,
covariate.labels = varlabs,
float = FALSE
# ,
# out = file.path(TABDIR, tabname)
)
cat(tab, sep = '\n', file = file.path(TABDIR, tabname))
vars <- c(
"^has_inflows$",
"^month_spend$",
"^is_urban$",
"^is_female$",
"^age$",
"^month_income$",
"^has_month_income$",
"^nunique_tag_spend$",
"^nunique_tag$",
"^nunique_merchant$"
)
varlabs <- c(
"Month income (\\pounds'000)",
"Has income in month",
"Makes savings txns.",
"Month spend (\\pounds'000)",
"Age (years)",
"Female",
"Urban",
"Unique categories (9)",
"Unique categories (48)",
"Unique categories (Merch.)"
)
# Workaround to handle pounds sign. See link below.
# https://github.com/markwestcott34/stargazer-booktabs/issues/3
tab <- stargazer(
df,
summary.stat = c('mean', 'sd', 'min', 'p25', 'median', 'p75', 'max'),
digits = 2,
keep = vars,
covariate.labels = varlabs,
float = FALSE
)
tabname <- 'sumstats.tex'
cat(tab, sep = '\n', file = file.path(TABDIR, tabname))

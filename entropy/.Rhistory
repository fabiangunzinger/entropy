'Spend hobbies',
'Spend household',
'Spend retail',
'Spend other'
),
report = 'vct',
keep.stat = c('n', 'rsq'),
no.space = TRUE,
dep.var.labels.include = FALSE,
dep.var.caption = "Dependent variable: has transfers into savings account",
omit = '^month\\d+$',
add.lines = list(
c('Individual fixed effects', 'Yes', 'Yes', 'Yes', 'Yes'),
c('Month fixed effects', 'Yes', 'Yes', 'Yes', 'Yes')
),
notes.align = 'l',
notes.append = FALSE,
notes.label = "",
notes = 'Note: ... *p<0.1; **p<0.05; ***p<0.01.',
label = 'tab:main_results'
# font.size = 'footnotesize',
)
source('~/dev/projects/entropy/entropy/analysis/analysis.R', echo=TRUE)
df
dt
source('~/dev/projects/entropy/entropy/analysis/analysis.R', echo=TRUE)
dt
dt
dt
dt[txns_count > 100]
dt[txns_count > 100, .SD %like% 'spend']
dt[txns_count > 100, .SD %like% '^spend']
dt[txns_count > 100, txns_value]
dt[txns_count > 100]
dt[txns_count %between% c(5, 20)]
dt[txns_count %between% .(5, 20)]
dt[txns_count %between% (5, 20)]
dt[txns_count %between% .(5, 20)]
dt[, spend_travel = spend_travel]
dt[, spend_travel := spend_travel]
k = dt
k <-  dt
dt[, spend_travel := 3]
dt = read_analysis_data()
dt = read_analysis_data()
d <- dt
d <- dt
d[, spend_travel := 3]
d
dt
dt = read_analysis_data()
d <- dt
d[, spend_travel := 3]
d
dt
dt = read_analysis_data()
# data prep ------------------------------------------------------------------------
d <- copy(dt)
d[, spend_travel := 3]
d
dt
d[, spend_travel := spend_travel * 1000]
d <- copy(dt)
d[, spend_travel := spend_travel * 1000]
d
dt = read_analysis_data()
dt
d[, spend_travel := spend_travel / 1000]
d <- copy(dt)
d[, spend_travel := spend_travel / 1000]
d
d[, .SD]
d[, .SDcols]
d[, .SD, .SDcols]
d[, .SD, .SDcols = pattern('spend')]
d[, .SD, .SDcols = patterns('spend')]
d[, .SDcols = patterns('spend')]
d[.SD, .SDcols = patterns('spend')]
d[, .SD, .SDcols = patterns('spend')]
?patterns
d[, .SD, .SDcols = patterns('spend|income')]
cols = grep('spend|income', names(d))
cols
cols = grep('spend|income', names(d), value = T)
cols
d[, cols]
d[, (cols)]
d[, .SD, SDcols = (cols)]
d[, .SD, SDcols = cols]
d[, cols]
d[, (cols)]
d[, .(cols)]
divide <- function(x){
return(x / 1000)
}
cols = grep('spend|income', names(d), value = T)
d[, (cols) := lapply(.SD, divide), .SDcols = cols]
d
Sys.setenv(AWS_PROFILE='3di', AWS_DEFAULT_REGION='eu-west-2')
setwd('~/dev/projects/entropy/entropy/analysis')
source('helpers.R')
library(data.table)
library(estimatr)
library(fixest)
library(modelsummary)
library(plm)
library(stargazer)
TABDIR = '/Users/fgu/dev/projects/entropy/output/tables'
dt = read_analysis_data()
# data prep ------------------------------------------------------------------------
d <- copy(dt)
d[, spend_travel := spend_travel / 1000]
d[, .SD, .SDcols = patterns('spend|income')]
# divide <- function(x){
#   return(x / 1000)
# }
cols = grep('spend|income', names(d), value = T)
d[, (cols) := lapply(.SD, divide, 10), .SDcols = cols]
d
d[, .(cols)]
d
d[, (cols) := lapply(.SD, divide), .SDcols = cols]
d[, (cols) := lapply(.SD, `\` 10), .SDcols = cols]
d
d
d / 10
d[, (cols) := lapply(.SD, `/` 10), .SDcols = cols]
d$month_income / 10
d$month_income / 10
d$month_income / 10
d$month_income / 10000
d$month_income `/` 10000
d <- copy(dt)
d[, spend_travel := spend_travel / 1000]
d[, .SD, .SDcols = patterns('spend|income')]
divider <- function(x){
return(x / 1000)
}
cols = grep('spend|income', names(d), value = T)
d[, (cols) := lapply(.SD, divider), .SDcols = cols]
d
Sys.setenv(AWS_PROFILE='3di', AWS_DEFAULT_REGION='eu-west-2')
setwd('~/dev/projects/entropy/entropy/analysis')
source('helpers.R')
library(data.table)
library(estimatr)
library(fixest)
library(modelsummary)
library(plm)
library(stargazer)
TABDIR = '/Users/fgu/dev/projects/entropy/output/tables'
dt = read_analysis_data()
# data prep ------------------------------------------------------------------------
divider <- function(x){
return(x / 1000)
}
cols = grep('spend|income', names(dt), value = T)
dt[, (cols) := lapply(.SD, divider), .SDcols = cols]
m1 <- plm(has_sa_inflows ~ entropyz + month,
data=dt, index = c('user_id'))
m2 <- plm(has_sa_inflows ~ entropyz + month_spend + month,
data=dt, index = c('user_id'))
m3 <- plm(has_sa_inflows ~ entropyz + month_spend + month_income + month,
data=dt, index = c('user_id'))
m4 <- plm(has_sa_inflows ~ entropyz + month_income + spend_communication + spend_services + spend_finance + spend_motor + spend_travel + spend_hobbies + spend_household + spend_retail + spend_other_spend + month,
data=dt, index = c('user_id'))
stargazer(
m1, m2, m3, m4,
type = 'text',
title='Main results',
covariate.labels = c(
'Entropy',
'Month spend',
'Month income',
'Spend communication',
'Spend services',
'Spend finance',
'Spend motor',
'Spend travel',
'Spend hobbies',
'Spend household',
'Spend retail',
'Spend other'
),
report = 'vc*t',
keep.stat = c('n', 'rsq'),
no.space = TRUE,
dep.var.labels.include = FALSE,
dep.var.caption = "Dependent variable: has transfers into savings account",
omit = '^month\\d+$',
add.lines = list(
c('Individual fixed effects', 'Yes', 'Yes', 'Yes', 'Yes'),
c('Month fixed effects', 'Yes', 'Yes', 'Yes', 'Yes')
),
notes.align = 'l',
notes.append = FALSE,
notes.label = "",
notes = 'Note: ... *p<0.1; **p<0.05; ***p<0.01.',
label = 'tab:main_results',
# font.size = 'footnotesize',
out=file.path(TABDIR, 'main_results.tex')
)
stargazer(
m1, m2, m3, m4,
type = 'text',
title='Main results',
covariate.labels = c(
'Entropy',
'Month spend',
'Month income',
'Spend communication',
'Spend services',
'Spend finance',
'Spend motor',
'Spend travel',
'Spend hobbies',
'Spend household',
'Spend retail',
'Spend other'
),
report = 'vc*t',
keep.stat = c('n', 'rsq'),
no.space = TRUE,
dep.var.labels.include = FALSE,
dep.var.caption = "Dependent variable: has transfers into savings account",
omit = '^month\\d+$',
add.lines = list(
c('Individual fixed effects', 'Yes', 'Yes', 'Yes', 'Yes'),
c('Month fixed effects', 'Yes', 'Yes', 'Yes', 'Yes')
),
notes.align = 'l',
notes.append = FALSE,
notes.label = "",
notes = "Note: Spend and income variables are in 000's. *p<0.1; **p<0.05; ***p<0.01.",
label = 'tab:main_results',
# font.size = 'footnotesize',
out=file.path(TABDIR, 'main_results.tex')
)
setwd('~/dev/projects/entropy/entropy/analysis')
source('helpers.R')
library(ggplot2)
library(patchwork)
FIGDIR = '/Users/fgu/dev/projects/entropy/output/figures'
dt = read_analysis_data()
dt
geom_count()
ggplot(dt, aes(as.Date(date))) +
geom_bar()
ggplot(dt, aes(weekdays(as.Date(date)))) +
geom_bar()
setwd('~/dev/projects/entropy/entropy/analysis')
source('helpers.R')
library(ggplot2)
library(patchwork)
dt = read_txns_data('777')
dt
dt = read_txns_data('777')
dt
dt = read_txns_data('777')
dt
source('helpers.R')
dt = read_txns_data('777')
dt = read_txns_data('777')
dt
source('helpers.R')
setwd('~/dev/projects/entropy/entropy/analysis')
source('helpers.R')
library(ggplot2)
library(patchwork)
FIGDIR = '/Users/fgu/dev/projects/entropy/output/figures'
## Day of week transactions
dt = read_txn_data('777')
dt
setwd('~/dev/projects/entropy/entropy/analysis')
source('helpers.R')
library(ggplot2)
library(patchwork)
FIGDIR = '/Users/fgu/dev/projects/entropy/output/figures'
## Day of week transactions
dt = read_txn_data('777')
dt
ggplot(dt, aes(weekdays(as.Date(dt$date)))) +
geom_count()
ggplot(dt, aes(weekdays(as.Date(dt$date)))) +
geom_histogram()
ggplot(dt, aes(weekdays(as.Date(dt$date)))) +
geom_bar()
p <- ggplot(dt, aes(weekdays(as.Date(dt$date)))) +
geom_bar()
p <- ggplot(dt, aes(weekdays(as.Date(dt$date)))) +
geom_bar() +
labs(
x = 'Day of week',
y = 'Number of transactions'
)
ggsave(file.path(FIGDIR, 'dow_txns.png'))
p <- ggplot(dt, aes(factor(weekdays(as.Date(dt$date))), level = day_order)) +
geom_bar() +
labs(
x = 'Day of week',
y = 'Number of transactions'
)
p
day_order <- c('Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday')
p <- ggplot(dt, aes(factor(weekdays(as.Date(dt$date))), level = day_order)) +
geom_bar() +
labs(
x = 'Day of week',
y = 'Number of transactions'
)
p
p <- ggplot(dt, aes(factor(weekdays(as.Date(dt$date)), level = day_order))) +
geom_bar() +
labs(
x = 'Day of week',
y = 'Number of transactions'
)
p
ggsave(file.path(FIGDIR, 'dow_txns.png'))
p <- ggplot(dt, aes(factor(weekdays(as.Date(dt$date)), level = day_order))) +
geom_bar() +
labs(
x = 'Day of week',
y = 'Number of transactions'
) & theme_minimal()
p
ggsave(file.path(FIGDIR, 'dow_txns.png'))
ggsave(file.path(FIGDIR, 'dow_txns.png'))
Sys.setenv(AWS_PROFILE='3di', AWS_DEFAULT_REGION='eu-west-2')
setwd('~/dev/projects/entropy/entropy/analysis')
source('helpers.R')
library(data.table)
library(estimatr)
library(fixest)
library(modelsummary)
library(plm)
library(stargazer)
TABDIR = '/Users/fgu/dev/projects/entropy/output/tables'
dt = read_analysis_data()
# data prep ------------------------------------------------------------------------
divider <- function(x){
return(x / 1000)
}
cols = grep('spend|income', names(dt), value = T)
dt[, (cols) := lapply(.SD, divider), .SDcols = cols]
m1 <- plm(has_sa_inflows ~ entropyz + month,
data=dt, index = c('user_id'))
m2 <- plm(has_sa_inflows ~ entropyz + month_spend + month,
data=dt, index = c('user_id'))
m3 <- plm(has_sa_inflows ~ entropyz + month_spend + month_income + month,
data=dt, index = c('user_id'))
m4 <- plm(has_sa_inflows ~ entropyz + month_income + spend_communication + spend_services + spend_finance + spend_motor + spend_travel + spend_hobbies + spend_household + spend_retail + spend_other_spend + month,
data=dt, index = c('user_id'))
stargazer(
m1, m2, m3, m4,
type = 'text',
title='Main results',
covariate.labels = c(
'Entropy',
'Month spend',
'Month income',
'Spend communication',
'Spend services',jkkjj
'Spend finance',
'Spend motor',
'Spend travel',
'Spend hobbies',
'Spend household',
'Spend retail',
'Spend other'
),
report = 'vc*t',
keep.stat = c('n', 'rsq'),
no.space = TRUE,
dep.var.labels.include = FALSE,
dep.var.caption = "Dependent variable: has transfers into savings account",
omit = '^month\\d+$',
add.lines = list(
c('Individual fixed effects', 'Yes', 'Yes', 'Yes', 'Yes'),
c('Month fixed effects', 'Yes', 'Yes', 'Yes', 'Yes')
),
notes.align = 'l',
notes.append = FALSE,
notes.label = "",
notes = "Note: Spend and income variables are in 000's. *p<0.1; **p<0.05; ***p<0.01.",
label = 'tab:main_results',
# font.size = 'footnotesize',
out=file.path(TABDIR, 'main_results.tex')
)
stargazer(
m1, m2, m3, m4,
type = 'text',
title='Main results',
covariate.labels = c(
'Entropy',
'Month spend',
'Month income',
'Spend communication',
'Spend services',
'Spend finance',
'Spend motor',
'Spend travel',
'Spend hobbies',
'Spend household',
'Spend retail',
'Spend other'
),
report = 'vc*t',
keep.stat = c('n', 'rsq'),
no.space = TRUE,
dep.var.labels.include = FALSE,
dep.var.caption = "Dependent variable: has transfers into savings account",
omit = '^month\\d+$',
add.lines = list(
c('Individual fixed effects', 'Yes', 'Yes', 'Yes', 'Yes'),
c('Month fixed effects', 'Yes', 'Yes', 'Yes', 'Yes')
),
notes.align = 'l',
notes.append = FALSE,
notes.label = "",
notes = "Note: Spend and income variables are in 000's. *p<0.1; **p<0.05; ***p<0.01.",
label = 'tab:main_results',
# font.size = 'footnotesize',
# out=file.path(TABDIR, 'main_results.tex')
)
stargazer(
m1, m2, m3, m4,
type = 'text',
title='Main results',
covariate.labels = c(
'Entropy',
'Month spend',
'Month income',
'Spend communication',
'Spend services',
'Spend finance',
'Spend motor',
'Spend travel',
'Spend hobbies',
'Spend household',
'Spend retail',
'Spend other'
),
report = 'vc*t',
keep.stat = c('n', 'rsq'),
no.space = TRUE,
dep.var.labels.include = FALSE,
dep.var.caption = "Dependent variable: has transfers into savings account",
omit = '^month\\d+$',
add.lines = list(
c('Individual fixed effects', 'Yes', 'Yes', 'Yes', 'Yes'),
c('Month fixed effects', 'Yes', 'Yes', 'Yes', 'Yes')
),
notes.align = 'l',
notes.append = FALSE,
notes.label = "",
notes = "Note: Spend and income variables are in 000's. *p<0.1; **p<0.05; ***p<0.01.",
label = 'tab:main_results'
# font.size = 'footnotesize',
# out=file.path(TABDIR, 'main_results.tex')
)
dt = read_analysis_data()
# data prep ------------------------------------------------------------------------
divider <- function(x){
return(x / 1000)
}
cols = grep('spend|income', names(dt), value = T)
dt[, (cols) := lapply(.SD, divider), .SDcols = cols]
m1 <- plm(has_sa_inflows ~ entropy + month,
data=dt, index = c('user_id'))
m2 <- plm(has_sa_inflows ~ entropy + month_spend + month,
data=dt, index = c('user_id'))
m3 <- plm(has_sa_inflows ~ entropy + month_spend + month_income + month,
data=dt, index = c('user_id'))
m4 <- plm(has_sa_inflows ~ entropy + month_income + spend_communication + spend_services + spend_finance + spend_motor + spend_travel + spend_hobbies + spend_household + spend_retail + spend_other_spend + month,
data=dt, index = c('user_id'))
stargazer(
m1, m2, m3, m4,
type = 'text',
title='Main results',
covariate.labels = c(
'Entropy',
'Month spend',
'Month income',
'Spend communication',
'Spend services',
'Spend finance',
'Spend motor',
'Spend travel',
'Spend hobbies',
'Spend household',
'Spend retail',
'Spend other'
),
report = 'vc*t',
keep.stat = c('n', 'rsq'),
no.space = TRUE,
dep.var.labels.include = FALSE,
dep.var.caption = "Dependent variable: has transfers into savings account",
omit = '^month\\d+$',
add.lines = list(
c('Individual fixed effects', 'Yes', 'Yes', 'Yes', 'Yes'),
c('Month fixed effects', 'Yes', 'Yes', 'Yes', 'Yes')
),
notes.align = 'l',
notes.append = FALSE,
notes.label = "",
notes = "Note: Spend and income variables are in 000's. *p<0.1; **p<0.05; ***p<0.01.",
label = 'tab:main_results'
# font.size = 'footnotesize',
# out=file.path(TABDIR, 'main_results.tex')
)
